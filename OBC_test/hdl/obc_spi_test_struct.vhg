--
-- VHDL Architecture OBC_test.OBC_SPI_test.struct
--
-- Created:
--          by - student.UNKNOWN (DESKTOP-3I0F3HP)
--          at - 15:13:10 17.07.2020
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2019.2 (Build 5)
--
LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;

LIBRARY OBC;
LIBRARY OBC_test;
LIBRARY SPI;

ARCHITECTURE struct OF OBC_SPI_test IS

   -- Architecture declarations
   constant dataBitNb : positive :=8;

   -- Internal signal declarations
   SIGNAL MOSI        : std_ulogic;
   SIGNAL SPI1_SS_n   : std_ulogic;
   SIGNAL SS1_n       : std_ulogic;
   SIGNAL SS2_n       : std_ulogic;
   SIGNAL SS3_n       : std_ulogic;
   SIGNAL SlaveSelect : unsigned(1 DOWNTO 0);
   SIGNAL clock       : std_logic;
   SIGNAL endTransfer : std_logic;
   SIGNAL masterData  : std_ulogic_vector(dataBitNb-1 DOWNTO 0);
   SIGNAL masterFull  : std_ulogic;
   SIGNAL masterWr    : std_ulogic;
   SIGNAL reset       : std_logic;
   SIGNAL sClk        : std_ulogic;
   SIGNAL slaveData   : std_ulogic_vector(dataBitNb-1 DOWNTO 0);
   SIGNAL slaveEmpty  : std_ulogic;
   SIGNAL slaveRd     : std_ulogic;


   -- Component Declarations
   COMPONENT SPI_SlaveSelect
   PORT (
      SS_n        : IN     std_ulogic ;
      SlaveSelect : IN     unsigned (1 DOWNTO 0);
      SS1_n       : OUT    std_ulogic ;
      SS2_n       : OUT    std_ulogic ;
      SS3_n       : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT OBC_SPI_TB
   GENERIC (
      dataBitNb : positive := 8
   );
   PORT (
      SS1_n       : IN     std_ulogic ;
      SS2_n       : IN     std_ulogic ;
      SS3_n       : IN     std_ulogic ;
      endTransfer : IN     std_logic ;
      masterFull  : IN     std_ulogic ;
      sClk        : IN     std_ulogic ;
      slaveData   : IN     std_ulogic_vector (dataBitNb-1 DOWNTO 0);
      slaveEmpty  : IN     std_ulogic ;
      SlaveSelect : OUT    unsigned (1 DOWNTO 0);
      clock       : OUT    std_logic ;
      masterData  : OUT    std_ulogic_vector (dataBitNb-1 DOWNTO 0);
      masterWr    : OUT    std_ulogic ;
      reset       : OUT    std_logic ;
      slaveRd     : OUT    std_ulogic 
   );
   END COMPONENT;
   COMPONENT spiFifo
   GENERIC (
      dataBitNb      : positive   := 8;
      fifoDepth      : positive   := 8;      --Max nbr of sequential transfers
      spiClockPeriod : positive   := 1;      --SPI clock divider
      spiFramePeriod : positive   := 1;      --SPI Inter Frame Gap
      cPol           : std_ulogic := '0';
      cPha           : std_ulogic := '0'
   );
   PORT (
      slaveRd     : IN     std_ulogic ;
      slaveData   : OUT    std_ulogic_vector (dataBitNb-1 DOWNTO 0);
      clock       : IN     std_ulogic ;
      MISO        : IN     std_ulogic ;
      reset       : IN     std_ulogic ;
      MOSI        : OUT    std_ulogic ;
      slaveEmpty  : OUT    std_ulogic ;
      masterFull  : OUT    std_ulogic ;
      masterData  : IN     std_ulogic_vector (dataBitNb-1 DOWNTO 0);
      masterWr    : IN     std_ulogic ;
      sClk        : OUT    std_ulogic ;
      endTransfer : OUT    std_logic ;
      SS_n        : OUT    std_ulogic 
   );
   END COMPONENT;

   -- Optional embedded configurations
   -- pragma synthesis_off
   FOR ALL : OBC_SPI_TB USE ENTITY OBC_test.OBC_SPI_TB;
   FOR ALL : SPI_SlaveSelect USE ENTITY OBC.SPI_SlaveSelect;
   FOR ALL : spiFifo USE ENTITY SPI.spiFifo;
   -- pragma synthesis_on


BEGIN

   -- Instance port mappings.
   U_0 : SPI_SlaveSelect
      PORT MAP (
         SS_n        => SPI1_SS_n,
         SlaveSelect => SlaveSelect,
         SS1_n       => SS1_n,
         SS2_n       => SS2_n,
         SS3_n       => SS3_n
      );
   U_1 : OBC_SPI_TB
      GENERIC MAP (
         dataBitNb => 8
      )
      PORT MAP (
         SS1_n       => SS1_n,
         SS2_n       => SS2_n,
         SS3_n       => SS3_n,
         endTransfer => endTransfer,
         masterFull  => masterFull,
         sClk        => sClk,
         slaveData   => slaveData,
         slaveEmpty  => slaveEmpty,
         SlaveSelect => SlaveSelect,
         clock       => clock,
         masterData  => masterData,
         masterWr    => masterWr,
         reset       => reset,
         slaveRd     => slaveRd
      );
   SPI1_Master : spiFifo
      GENERIC MAP (
         dataBitNb      => 8,
         fifoDepth      => 8,         --Max nbr of sequential transfers
         spiClockPeriod => 1,         --SPI clock divider
         spiFramePeriod => 1,         --SPI Inter Frame Gap
         cPol           => '0',
         cPha           => '0'
      )
      PORT MAP (
         slaveRd     => slaveRd,
         slaveData   => slaveData,
         clock       => clock,
         MISO        => MOSI,
         reset       => reset,
         MOSI        => MOSI,
         slaveEmpty  => slaveEmpty,
         masterFull  => masterFull,
         masterData  => masterData,
         masterWr    => masterWr,
         sClk        => sClk,
         endTransfer => endTransfer,
         SS_n        => SPI1_SS_n
      );

END struct;
